import{j as e,a as P,r as l,H as U,L as q}from"./app-GeuNv2U7.js";import{X as G,A as V}from"./app-layout-cqTJQ3KW.js";import{d as W}from"./index-4Ns3tNZl.js";import{a as F,c as x,B as c}from"./createLucideIcon-qm2xpo58.js";import{u as X,a as Z,b as $,c as J,F as K,d as f,e as N,f as b,g as S,i as k,h as Q,S as Y,T as ee,I as se,o as ae,j as te,k as re,s as C,l as ie,m as ne}from"./useServices-CB--JL-8.js";import{I as D}from"./input-DroGl5VL.js";import{L as le}from"./loader-circle-Dj50IK_Q.js";import{D as L,a as T,b as _,c as I,d as ce,e as oe}from"./dialog-CJYwEjak.js";import{B as de}from"./badge-BPhHgc4z.js";/* empty css            */import"./index-BeS1Fj6_.js";import"./index-DQo6JsRl.js";import"./index-Cn5BLyUM.js";import"./label-BpM_bxwD.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],xe=F("Plus",me);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],he=F("Search",ue);function v({className:s,...a}){return e.jsx("div",{"data-slot":"skeleton",className:x("bg-primary/10 animate-pulse rounded-md",s),...a})}const je=ae({name:C().min(1,{message:"Le nom du service est requis."}),description:C().min(10,{message:"La description doit contenir au moins 10 caractères."}),is_active:re(),image:te().optional()});function pe({service:s,onSuccess:a,onCancel:t}){const n=!!s,r=X(),o=Z(),m=n?o:r,d=$({resolver:J(je),defaultValues:{name:s?.name??"",description:s?.description??"",is_active:s?.is_active??!0}}),p=i=>{const j=new FormData;j.append("name",i.name),j.append("description",i.description),j.append("is_active",String(i.is_active)),i.image&&i.image instanceof File&&j.append("image",i.image),n&&s?o.mutate({id:s.id.toString(),data:i},{onSuccess:()=>{P.visit("/company-services/home",{replace:!0})}}):r.mutate(i,{onSuccess:()=>{a()}})};return e.jsx(K,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(p),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsx(f,{control:d.control,name:"name",render:({field:i})=>e.jsxs(N,{children:[e.jsx(b,{children:"Nom du service"}),e.jsx(S,{children:e.jsx(D,{placeholder:"Nom du service",...i})}),e.jsx(k,{})]})}),e.jsx(f,{control:d.control,name:"is_active",render:({field:i})=>e.jsxs(N,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{className:"text-base",children:"Service actif"}),e.jsx(Q,{children:"Ce service sera visible pour les clients s'il est actif"})]}),e.jsx(S,{children:e.jsx(Y,{checked:i.value,onCheckedChange:i.onChange})})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(f,{control:d.control,name:"description",render:({field:i})=>e.jsxs(N,{children:[e.jsx(b,{children:"Description"}),e.jsx(S,{children:e.jsx(ee,{placeholder:"Décrivez le service en détail...",className:"min-h-[120px]",...i})}),e.jsx(k,{})]})})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(f,{control:d.control,name:"image",render:({field:i})=>e.jsx(se,{label:"Image du service",field:i,defaultImageUrl:s?.image})})})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(c,{type:"button",variant:"outline",onClick:t,disabled:m.isPending,children:"Annuler"}),e.jsxs(c,{type:"submit",disabled:m.isPending,children:[m.isPending&&e.jsx(le,{className:"mr-2 h-4 w-4 animate-spin"}),n?"Mettre à jour":"Créer le service"]})]})]})})}function fe({isOpen:s,service:a,onClose:t,onSuccess:n}){const r=()=>{t(),n?.()};return e.jsx(L,{open:s,onOpenChange:t,children:e.jsxs(T,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsx(_,{children:e.jsx(I,{children:a?"Modifier le service":"Ajouter un nouveau service"})}),e.jsx(pe,{service:a||void 0,onSuccess:r,onCancel:t})]})})}function ve({isOpen:s,serviceId:a,onClose:t,onSuccess:n}){const r=ie(),o=()=>{a&&r.mutate(a,{onSuccess:()=>{t(),n?.()}})};return e.jsx(L,{open:s,onOpenChange:t,children:e.jsxs(T,{className:"sm:max-w-[425px]",children:[e.jsxs(_,{children:[e.jsx(I,{children:"Supprimer le service"}),e.jsx(ce,{children:"Êtes-vous sûr de vouloir supprimer ce service ? Cette action est irréversible."})]}),e.jsxs(oe,{className:"mt-4",children:[e.jsx(c,{variant:"outline",onClick:t,disabled:r.isPending,children:"Annuler"}),e.jsx(c,{variant:"destructive",onClick:o,disabled:r.isPending,className:"ml-2",children:r.isPending?"Suppression...":"Supprimer"})]})]})})}const R=l.forwardRef(({className:s,...a},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:x("w-full caption-bottom text-sm",s),...a})}));R.displayName="Table";const M=l.forwardRef(({className:s,...a},t)=>e.jsx("thead",{ref:t,className:x("[&_tr]:border-b",s),...a}));M.displayName="TableHeader";const E=l.forwardRef(({className:s,...a},t)=>e.jsx("tbody",{ref:t,className:x("[&_tr:last-child]:border-0",s),...a}));E.displayName="TableBody";const ge=l.forwardRef(({className:s,...a},t)=>e.jsx("tfoot",{ref:t,className:x("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a}));ge.displayName="TableFooter";const w=l.forwardRef(({className:s,...a},t)=>e.jsx("tr",{ref:t,className:x("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a}));w.displayName="TableRow";const u=l.forwardRef(({className:s,...a},t)=>e.jsx("th",{ref:t,className:x("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...a}));u.displayName="TableHead";const h=l.forwardRef(({className:s,...a},t)=>e.jsx("td",{ref:t,className:x("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...a}));h.displayName="TableCell";const Ne=l.forwardRef(({className:s,...a},t)=>e.jsx("caption",{ref:t,className:x("mt-4 text-sm text-muted-foreground",s),...a}));Ne.displayName="TableCaption";function be({src:s,fallbackSrc:a="/images/placeholder.svg",alt:t,...n}){const[r,o]=l.useState(s),[m,d]=l.useState(!1),p=()=>{m||(o(a),d(!0))};return e.jsx("img",{src:m?a:r,onError:p,alt:t||"",...n})}function Se({services:s,isLoading:a,onEdit:t,onDelete:n}){return console.log("ServicesList - services:",s),console.log("ServicesList - isLoading:",a),console.log("ServicesList - services type:",typeof s),console.log("ServicesList - services length:",s?.length),a?e.jsx("div",{className:"p-4",children:[...Array(5)].map((r,o)=>e.jsxs("div",{className:"mb-4 flex items-center space-x-4 p-4",children:[e.jsx(v,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(v,{className:"h-4 w-3/4"}),e.jsx(v,{className:"h-4 w-1/2"})]}),e.jsx(v,{className:"h-8 w-8 rounded-full"})]},o))}):!s||s.length===0?e.jsx("div",{className:"flex h-48 items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Aucun service trouvé."})})}):e.jsxs(R,{children:[e.jsx(M,{children:e.jsxs(w,{children:[e.jsx(u,{children:"Image"}),e.jsx(u,{children:"Nom"}),e.jsx(u,{children:"Description"}),e.jsx(u,{className:"text-right",children:"Prix"}),e.jsx(u,{children:"Durée"}),e.jsx(u,{children:"Statut"}),e.jsx(u,{className:"text-right",children:"Actions"})]})}),e.jsx(E,{children:s.map(r=>e.jsxs(w,{children:[e.jsx(h,{children:e.jsx("div",{className:"w-12 h-12 rounded-md overflow-hidden",children:e.jsx(be,{src:r.image,alt:r.name,className:"w-full h-full object-cover"})})}),e.jsx(h,{className:"font-medium",children:r.name}),e.jsx(h,{className:"max-w-xs truncate",children:r.description}),e.jsx(h,{className:"text-right",children:new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(r.price)}),e.jsx(h,{children:r.duration}),e.jsx(h,{children:e.jsx(de,{variant:r.is_active?"default":"secondary",children:r.is_active?"Actif":"Inactif"})}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>t(r),title:"Modifier",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),e.jsx("path",{d:"m15 5 4 4"})]})}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>n(r.id),className:"text-destructive hover:text-destructive/90",title:"Supprimer",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]})})]})})]},r.id))})]})}function we({search:s,isActive:a,onSearchChange:t,onIsActiveChange:n}){const r=s||a!==null,o=()=>{t(""),n(null)};return e.jsxs("div",{className:"flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0",children:[e.jsxs("div",{className:"relative w-full md:max-w-sm",children:[e.jsx(he,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(D,{type:"search",placeholder:"Rechercher un service...",className:"w-full pl-8",value:s,onChange:m=>t(m.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{variant:a===!0?"default":"outline",onClick:()=>n(a===!0?null:!0),children:"Actifs"}),e.jsx(c,{variant:a===!1?"default":"outline",onClick:()=>n(a===!1?null:!1),children:"Inactifs"}),r&&e.jsxs(c,{variant:"ghost",onClick:o,children:["Réinitialiser",e.jsx(G,{className:"ml-2 h-4 w-4"})]})]})]})}function ye({currentPage:s,totalPages:a,onPageChange:t}){return a<=1?null:e.jsxs("div",{className:"flex items-center justify-end space-x-2 p-4 border-t",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>t(1),disabled:s===1,children:"Première page"}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>t(s-1),disabled:s===1,children:"Précédent"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",s," sur ",a]}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>t(s+1),disabled:s===a,children:"Suivant"}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>t(a),disabled:s===a,children:"Dernière page"})]})}const ke=[{title:"Tableau de bord",href:W().url},{title:"Services"}];function Oe(){const[s,a]=l.useState(""),[t,n]=l.useState(!0),[r,o]=l.useState(1),[m,d]=l.useState(!1),[p,i]=l.useState(null),[j,g]=l.useState(null),{data:y,isLoading:H}=ne({search:s,is_active:t,page:r}),z=O=>{i(O),d(!0)},A=()=>{d(!1),i(null)},B=()=>{g(null)};return e.jsxs(V,{breadcrumbs:ke,children:[e.jsx(U,{title:"Gestion des services"}),e.jsxs("div",{className:"flex flex-col space-y-6 px-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestion des services"}),e.jsx("p",{className:"text-muted-foreground",children:"Gérez les services proposés par votre entreprise"})]}),e.jsx(c,{asChild:!0,children:e.jsxs(q,{href:"/company-services/create",prefetch:!0,children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Ajouter un service"]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"p-4",children:e.jsx(we,{search:s,isActive:t,onSearchChange:a,onIsActiveChange:n})}),e.jsxs("div",{className:"border-t",children:[e.jsx(Se,{services:y?.data||[],isLoading:H,onEdit:z,onDelete:g}),e.jsx(ye,{currentPage:r,totalPages:y?.meta?.last_page||1,onPageChange:o})]})]})]}),e.jsx(fe,{isOpen:m,service:p,onClose:()=>{d(!1),i(null)},onSuccess:A}),e.jsx(ve,{isOpen:!!j,serviceId:j,onClose:()=>g(null),onSuccess:B})]})}export{Oe as default};
