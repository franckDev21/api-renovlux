import{r as m,j as e,a as f,H as P,L as R}from"./app-CXlkSNpp.js";import{D as N,b as D,c as k,d as M,e as I,f as h,g as V,A as F}from"./app-layout-BAa8lCS0.js";import{d as A}from"./index-4Ns3tNZl.js";import{B as n}from"./createLucideIcon-TuM7M0fl.js";import{u as T,f as v,g as H,a as _,b as E,c as L,A as p,E as K}from"./index-BG6_3_t0.js";import{T as z,a as B,b as j,c as G,d as O,e as C}from"./table-DDpxDCWc.js";import{I as U}from"./input-DNPMUi4O.js";import{C as b}from"./checkbox-CI_UBlM-.js";import{B as S}from"./badge-CqJOE_uh.js";import{c as $,d as q}from"./useProducts-DGwjVx5K.js";import{S as w}from"./skeleton-DkmOLbKu.js";import{D as J,a as Q,b as W,c as X,d as Y,e as Z}from"./dialog-pW_HPSkb.js";import{P as ee}from"./plus-Ct8jtTmn.js";/* empty css            */import"./index-Dt3f-TAq.js";import"./index-Dd6kHcB0.js";import"./index-BGOW-8nH.js";import"./useMutation-Snm-uatt.js";function se({columns:o,data:s}){const[t,a]=m.useState([]),[d,c]=m.useState([]),[u,x]=m.useState({}),[g,y]=m.useState({}),l=T({data:s,columns:o,getCoreRowModel:L(),getPaginationRowModel:E(),onSortingChange:a,getSortedRowModel:_(),onColumnFiltersChange:c,getFilteredRowModel:H(),onColumnVisibilityChange:x,onRowSelectionChange:y,state:{sorting:t,columnFilters:d,columnVisibility:u,rowSelection:g}});return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center py-4",children:[e.jsx(U,{placeholder:"Rechercher par nom...",value:l.getColumn("name")?.getFilterValue()??"",onChange:r=>l.getColumn("name")?.setFilterValue(r.target.value),className:"max-w-sm"}),e.jsxs(N,{children:[e.jsx(D,{asChild:!0,children:e.jsx(n,{variant:"outline",className:"ml-auto",children:"Colonnes"})}),e.jsx(k,{align:"end",children:l.getAllColumns().filter(r=>r.getCanHide()).map(r=>e.jsx(M,{className:"capitalize",checked:r.getIsVisible(),onCheckedChange:i=>r.toggleVisibility(!!i),children:r.id},r.id))})]})]}),e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs(z,{children:[e.jsx(B,{children:l.getHeaderGroups().map(r=>e.jsx(j,{children:r.headers.map(i=>e.jsx(G,{children:i.isPlaceholder?null:v(i.column.columnDef.header,i.getContext())},i.id))},r.id))}),e.jsx(O,{children:l.getRowModel().rows?.length?l.getRowModel().rows.map(r=>e.jsx(j,{"data-state":r.getIsSelected()&&"selected",children:r.getVisibleCells().map(i=>e.jsx(C,{children:v(i.column.columnDef.cell,i.getContext())},i.id))},r.id)):e.jsx(j,{children:e.jsx(C,{colSpan:o.length,className:"h-24 text-center",children:"Aucun résultat."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>l.previousPage(),disabled:!l.getCanPreviousPage(),children:"Précédent"}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>l.nextPage(),disabled:!l.getCanNextPage(),children:"Suivant"})]})]})}const te=o=>[{id:"select",header:({table:s})=>e.jsx(b,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t),"aria-label":"Sélectionner tout"}),cell:({row:s})=>e.jsx(b,{checked:s.getIsSelected(),onCheckedChange:t=>s.toggleSelected(!!t),"aria-label":"Sélectionner la ligne"}),enableSorting:!1,enableHiding:!1},{accessorKey:"image_principale",header:"Image",cell:({row:s})=>{const t=s.getValue("image_principale");return e.jsx("div",{className:"w-16 h-16 rounded-md overflow-hidden border",children:t?e.jsx("img",{src:t,alt:s.original.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-muted text-muted-foreground text-xs",children:"Aucune image"})})},enableSorting:!1},{accessorKey:"name",header:({column:s})=>e.jsxs(n,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Nom",e.jsx(p,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>e.jsx("div",{className:"font-medium",children:s.getValue("name")})},{accessorKey:"price",header:({column:s})=>e.jsx("div",{className:"text-right",children:e.jsxs(n,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Prix",e.jsx(p,{className:"ml-2 h-4 w-4"})]})}),cell:({row:s})=>{const t=parseFloat(s.getValue("price")),a=new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(t);return e.jsx("div",{className:"text-right font-medium",children:a})}},{accessorKey:"en_stock",header:"Stock",cell:({row:s})=>{const t=s.getValue("en_stock");return e.jsx(S,{variant:t?"default":"destructive",children:t?"En stock":"Rupture"})}},{accessorKey:"active",header:"Statut",cell:({row:s})=>{const t=s.getValue("active");return e.jsx(S,{variant:t?"default":"secondary",children:t?"Actif":"Inactif"})}},{accessorKey:"created_at",header:({column:s})=>e.jsxs(n,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Date de création",e.jsx(p,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>{const t=new Date(s.getValue("created_at"));return e.jsx("div",{children:t.toLocaleDateString("fr-FR")})}},{id:"actions",cell:({row:s})=>{const t=s.original;return e.jsxs(N,{children:[e.jsx(D,{asChild:!0,children:e.jsxs(n,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Ouvrir le menu"}),e.jsx(K,{className:"h-4 w-4"})]})}),e.jsxs(k,{align:"end",children:[e.jsx(I,{children:"Actions"}),e.jsx(h,{onClick:()=>navigator.clipboard.writeText(t.id),children:"Copier l'ID du produit"}),e.jsx(V,{}),e.jsx(h,{onClick:()=>f.visit(`/products/${t.id}`),children:"Voir les détails"}),e.jsx(h,{onClick:()=>f.visit(`/products/${t.id}/edit`),children:"Modifier"}),e.jsx(h,{className:"text-destructive",onClick:()=>o?.(t),children:"Supprimer"})]})]})}}];function re({isOpen:o,productId:s,productName:t,onClose:a,onSuccess:d}){const c=$(),u=()=>{s&&c.mutate(s,{onSuccess:()=>{a(),d?.()}})};return e.jsx(J,{open:o,onOpenChange:a,children:e.jsxs(Q,{className:"sm:max-w-[425px]",children:[e.jsxs(W,{children:[e.jsx(X,{children:"Supprimer le produit"}),e.jsx(Y,{children:t?e.jsxs(e.Fragment,{children:["Êtes-vous sûr de vouloir supprimer le produit ",e.jsxs("strong",{children:['"',t,'"']})," ? Cette action est irréversible et supprimera également toutes les images associées."]}):e.jsx(e.Fragment,{children:"Êtes-vous sûr de vouloir supprimer ce produit ? Cette action est irréversible et supprimera également toutes les images associées."})})]}),e.jsxs(Z,{className:"mt-4",children:[e.jsx(n,{variant:"outline",onClick:a,disabled:c.isPending,children:"Annuler"}),e.jsx(n,{variant:"destructive",onClick:u,disabled:c.isPending,className:"ml-2",children:c.isPending?"Suppression...":"Supprimer"})]})]})})}function ae(){const{data:o,isLoading:s,error:t}=q(),[a,d]=m.useState(null),c=g=>{d({id:g.id,name:g.name})},u=()=>{d(null)};if(s)return e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(w,{className:"h-10 w-full"}),e.jsx(w,{className:"h-64 w-full"})]});if(t)return e.jsx("div",{className:"p-4 text-center text-destructive",children:"Erreur lors du chargement des produits. Veuillez réessayer."});const x=o?.data||[];return e.jsxs(e.Fragment,{children:[e.jsx(se,{columns:te(c),data:x}),e.jsx(re,{isOpen:!!a,productId:a?.id||null,productName:a?.name,onClose:()=>d(null),onSuccess:u})]})}const le=[{title:"Tableau de bord",href:A().url},{title:"Produits"}];function Ne(){return e.jsxs(F,{breadcrumbs:le,children:[e.jsx(P,{title:"Gestion des produits"}),e.jsxs("div",{className:"flex flex-col space-y-6 px-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestion des produits"}),e.jsx("p",{className:"text-muted-foreground",children:"Gérez les produits de votre catalogue"})]}),e.jsx(n,{asChild:!0,children:e.jsxs(R,{href:"/products/create",prefetch:!0,children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Ajouter un produit"]})})]}),e.jsx("div",{className:"rounded-lg border bg-card",children:e.jsx(ae,{})})]})]})}export{Ne as default};
