import{r,j as t,b as pt,a as Re}from"./app-CXlkSNpp.js";import{u as mt,a as ft,F as gt,b as se,I as ht,c as ye,d as we,e as Ce,f as xt,g as Ie,T as vt,o as St,k as yt,s as le,n as wt,h as Me,i as Ae}from"./ImageUploadField-D56VYx-p.js";import{a as Oe,u as O,b as Ct,c as te,B as It}from"./createLucideIcon-TuM7M0fl.js";import{I as _t}from"./input-DNPMUi4O.js";import{M as bt}from"./MultiImageUploadField-cdYX7BoN.js";import{P as R,r as ke}from"./index-Dd6kHcB0.js";import{u as De,c as Tt,a as P,d as $,C as Pt}from"./index-Dt3f-TAq.js";import{h as Ve,u as Nt,R as Et,i as Ee,j as jt,k as Rt,P as Mt,V as At,l as Dt,m as Lt,n as Ot,o as kt,F as Vt,p as Bt,C as Ft,q as Ht}from"./app-layout-BAa8lCS0.js";import{u as Ut}from"./index-BGOW-8nH.js";import{a as Wt,b as zt}from"./useProjects-BPdE8pow.js";import{u as Kt}from"./useMutation-Snm-uatt.js";import{L as $t}from"./loader-circle-Ditl4NiH.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Be=Oe("ChevronDown",qt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Yt=Oe("ChevronUp",Gt);function Le(e,[n,o]){return Math.min(o,Math.max(n,e))}var Xt=[" ","Enter","ArrowUp","ArrowDown"],Zt=[" ","Enter"],Q="Select",[ue,pe,Qt]=jt(Q),[oe,tn]=Tt(Q,[Qt,Ve]),me=Ve(),[Jt,q]=oe(Q),[eo,to]=oe(Q),Fe=e=>{const{__scopeSelect:n,children:o,open:c,defaultOpen:i,onOpenChange:u,value:s,defaultValue:a,onValueChange:l,dir:d,name:x,autoComplete:m,disabled:S,required:w,form:y}=e,p=me(n),[h,C]=r.useState(null),[g,v]=r.useState(null),[U,M]=r.useState(!1),ne=Nt(d),[N,D]=De({prop:c,defaultProp:i??!1,onChange:u,caller:Q}),[W,Y]=De({prop:s,defaultProp:a,onChange:l,caller:Q}),k=r.useRef(null),V=h?y||!!h.closest("form"):!0,[z,B]=r.useState(new Set),F=Array.from(z).map(E=>E.props.value).join(";");return t.jsx(Et,{...p,children:t.jsxs(Jt,{required:w,scope:n,trigger:h,onTriggerChange:C,valueNode:g,onValueNodeChange:v,valueNodeHasChildren:U,onValueNodeHasChildrenChange:M,contentId:Ee(),value:W,onValueChange:Y,open:N,onOpenChange:D,dir:ne,triggerPointerDownPosRef:k,disabled:S,children:[t.jsx(ue.Provider,{scope:n,children:t.jsx(eo,{scope:e.__scopeSelect,onNativeOptionAdd:r.useCallback(E=>{B(L=>new Set(L).add(E))},[]),onNativeOptionRemove:r.useCallback(E=>{B(L=>{const H=new Set(L);return H.delete(E),H})},[]),children:o})}),V?t.jsxs(ct,{"aria-hidden":!0,required:w,tabIndex:-1,name:x,autoComplete:m,value:W,onChange:E=>Y(E.target.value),disabled:S,form:y,children:[W===void 0?t.jsx("option",{value:""}):null,Array.from(z)]},F):null]})})};Fe.displayName=Q;var He="SelectTrigger",Ue=r.forwardRef((e,n)=>{const{__scopeSelect:o,disabled:c=!1,...i}=e,u=me(o),s=q(He,o),a=s.disabled||c,l=O(n,s.onTriggerChange),d=pe(o),x=r.useRef("touch"),[m,S,w]=dt(p=>{const h=d().filter(v=>!v.disabled),C=h.find(v=>v.value===s.value),g=ut(h,p,C);g!==void 0&&s.onValueChange(g.value)}),y=p=>{a||(s.onOpenChange(!0),w()),p&&(s.triggerPointerDownPosRef.current={x:Math.round(p.pageX),y:Math.round(p.pageY)})};return t.jsx(Rt,{asChild:!0,...u,children:t.jsx(R.button,{type:"button",role:"combobox","aria-controls":s.contentId,"aria-expanded":s.open,"aria-required":s.required,"aria-autocomplete":"none",dir:s.dir,"data-state":s.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":lt(s.value)?"":void 0,...i,ref:l,onClick:P(i.onClick,p=>{p.currentTarget.focus(),x.current!=="mouse"&&y(p)}),onPointerDown:P(i.onPointerDown,p=>{x.current=p.pointerType;const h=p.target;h.hasPointerCapture(p.pointerId)&&h.releasePointerCapture(p.pointerId),p.button===0&&p.ctrlKey===!1&&p.pointerType==="mouse"&&(y(p),p.preventDefault())}),onKeyDown:P(i.onKeyDown,p=>{const h=m.current!=="";!(p.ctrlKey||p.altKey||p.metaKey)&&p.key.length===1&&S(p.key),!(h&&p.key===" ")&&Xt.includes(p.key)&&(y(),p.preventDefault())})})})});Ue.displayName=He;var We="SelectValue",ze=r.forwardRef((e,n)=>{const{__scopeSelect:o,className:c,style:i,children:u,placeholder:s="",...a}=e,l=q(We,o),{onValueNodeHasChildrenChange:d}=l,x=u!==void 0,m=O(n,l.onValueNodeChange);return $(()=>{d(x)},[d,x]),t.jsx(R.span,{...a,ref:m,style:{pointerEvents:"none"},children:lt(l.value)?t.jsx(t.Fragment,{children:s}):u})});ze.displayName=We;var oo="SelectIcon",Ke=r.forwardRef((e,n)=>{const{__scopeSelect:o,children:c,...i}=e;return t.jsx(R.span,{"aria-hidden":!0,...i,ref:n,children:c||"▼"})});Ke.displayName=oo;var no="SelectPortal",$e=e=>t.jsx(Mt,{asChild:!0,...e});$e.displayName=no;var J="SelectContent",qe=r.forwardRef((e,n)=>{const o=q(J,e.__scopeSelect),[c,i]=r.useState();if($(()=>{i(new DocumentFragment)},[]),!o.open){const u=c;return u?ke.createPortal(t.jsx(Ge,{scope:e.__scopeSelect,children:t.jsx(ue.Slot,{scope:e.__scopeSelect,children:t.jsx("div",{children:e.children})})}),u):null}return t.jsx(Ye,{...e,ref:n})});qe.displayName=J;var A=10,[Ge,G]=oe(J),ro="SelectContentImpl",so=Ct("SelectContent.RemoveScroll"),Ye=r.forwardRef((e,n)=>{const{__scopeSelect:o,position:c="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:u,onPointerDownOutside:s,side:a,sideOffset:l,align:d,alignOffset:x,arrowPadding:m,collisionBoundary:S,collisionPadding:w,sticky:y,hideWhenDetached:p,avoidCollisions:h,...C}=e,g=q(J,o),[v,U]=r.useState(null),[M,ne]=r.useState(null),N=O(n,f=>U(f)),[D,W]=r.useState(null),[Y,k]=r.useState(null),V=pe(o),[z,B]=r.useState(!1),F=r.useRef(!1);r.useEffect(()=>{if(v)return Lt(v)},[v]),Ot();const E=r.useCallback(f=>{const[b,...j]=V().map(T=>T.ref.current),[I]=j.slice(-1),_=document.activeElement;for(const T of f)if(T===_||(T?.scrollIntoView({block:"nearest"}),T===b&&M&&(M.scrollTop=0),T===I&&M&&(M.scrollTop=M.scrollHeight),T?.focus(),document.activeElement!==_))return},[V,M]),L=r.useCallback(()=>E([D,v]),[E,D,v]);r.useEffect(()=>{z&&L()},[z,L]);const{onOpenChange:H,triggerPointerDownPosRef:K}=g;r.useEffect(()=>{if(v){let f={x:0,y:0};const b=I=>{f={x:Math.abs(Math.round(I.pageX)-(K.current?.x??0)),y:Math.abs(Math.round(I.pageY)-(K.current?.y??0))}},j=I=>{f.x<=10&&f.y<=10?I.preventDefault():v.contains(I.target)||H(!1),document.removeEventListener("pointermove",b),K.current=null};return K.current!==null&&(document.addEventListener("pointermove",b),document.addEventListener("pointerup",j,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",j,{capture:!0})}}},[v,H,K]),r.useEffect(()=>{const f=()=>H(!1);return window.addEventListener("blur",f),window.addEventListener("resize",f),()=>{window.removeEventListener("blur",f),window.removeEventListener("resize",f)}},[H]);const[fe,ie]=dt(f=>{const b=V().filter(_=>!_.disabled),j=b.find(_=>_.ref.current===document.activeElement),I=ut(b,f,j);I&&setTimeout(()=>I.ref.current.focus())}),ge=r.useCallback((f,b,j)=>{const I=!F.current&&!j;(g.value!==void 0&&g.value===b||I)&&(W(f),I&&(F.current=!0))},[g.value]),he=r.useCallback(()=>v?.focus(),[v]),ee=r.useCallback((f,b,j)=>{const I=!F.current&&!j;(g.value!==void 0&&g.value===b||I)&&k(f)},[g.value]),ce=c==="popper"?_e:Xe,re=ce===_e?{side:a,sideOffset:l,align:d,alignOffset:x,arrowPadding:m,collisionBoundary:S,collisionPadding:w,sticky:y,hideWhenDetached:p,avoidCollisions:h}:{};return t.jsx(Ge,{scope:o,content:v,viewport:M,onViewportChange:ne,itemRefCallback:ge,selectedItem:D,onItemLeave:he,itemTextRefCallback:ee,focusSelectedItem:L,selectedItemText:Y,position:c,isPositioned:z,searchRef:fe,children:t.jsx(kt,{as:so,allowPinchZoom:!0,children:t.jsx(Vt,{asChild:!0,trapped:g.open,onMountAutoFocus:f=>{f.preventDefault()},onUnmountAutoFocus:P(i,f=>{g.trigger?.focus({preventScroll:!0}),f.preventDefault()}),children:t.jsx(Bt,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:u,onPointerDownOutside:s,onFocusOutside:f=>f.preventDefault(),onDismiss:()=>g.onOpenChange(!1),children:t.jsx(ce,{role:"listbox",id:g.contentId,"data-state":g.open?"open":"closed",dir:g.dir,onContextMenu:f=>f.preventDefault(),...C,...re,onPlaced:()=>B(!0),ref:N,style:{display:"flex",flexDirection:"column",outline:"none",...C.style},onKeyDown:P(C.onKeyDown,f=>{const b=f.ctrlKey||f.altKey||f.metaKey;if(f.key==="Tab"&&f.preventDefault(),!b&&f.key.length===1&&ie(f.key),["ArrowUp","ArrowDown","Home","End"].includes(f.key)){let I=V().filter(_=>!_.disabled).map(_=>_.ref.current);if(["ArrowUp","End"].includes(f.key)&&(I=I.slice().reverse()),["ArrowUp","ArrowDown"].includes(f.key)){const _=f.target,T=I.indexOf(_);I=I.slice(T+1)}setTimeout(()=>E(I)),f.preventDefault()}})})})})})})});Ye.displayName=ro;var ao="SelectItemAlignedPosition",Xe=r.forwardRef((e,n)=>{const{__scopeSelect:o,onPlaced:c,...i}=e,u=q(J,o),s=G(J,o),[a,l]=r.useState(null),[d,x]=r.useState(null),m=O(n,N=>x(N)),S=pe(o),w=r.useRef(!1),y=r.useRef(!0),{viewport:p,selectedItem:h,selectedItemText:C,focusSelectedItem:g}=s,v=r.useCallback(()=>{if(u.trigger&&u.valueNode&&a&&d&&p&&h&&C){const N=u.trigger.getBoundingClientRect(),D=d.getBoundingClientRect(),W=u.valueNode.getBoundingClientRect(),Y=C.getBoundingClientRect();if(u.dir!=="rtl"){const _=Y.left-D.left,T=W.left-_,X=N.left-T,Z=N.width+X,xe=Math.max(Z,D.width),ve=window.innerWidth-A,Se=Le(T,[A,Math.max(A,ve-xe)]);a.style.minWidth=Z+"px",a.style.left=Se+"px"}else{const _=D.right-Y.right,T=window.innerWidth-W.right-_,X=window.innerWidth-N.right-T,Z=N.width+X,xe=Math.max(Z,D.width),ve=window.innerWidth-A,Se=Le(T,[A,Math.max(A,ve-xe)]);a.style.minWidth=Z+"px",a.style.right=Se+"px"}const k=S(),V=window.innerHeight-A*2,z=p.scrollHeight,B=window.getComputedStyle(d),F=parseInt(B.borderTopWidth,10),E=parseInt(B.paddingTop,10),L=parseInt(B.borderBottomWidth,10),H=parseInt(B.paddingBottom,10),K=F+E+z+H+L,fe=Math.min(h.offsetHeight*5,K),ie=window.getComputedStyle(p),ge=parseInt(ie.paddingTop,10),he=parseInt(ie.paddingBottom,10),ee=N.top+N.height/2-A,ce=V-ee,re=h.offsetHeight/2,f=h.offsetTop+re,b=F+E+f,j=K-b;if(b<=ee){const _=k.length>0&&h===k[k.length-1].ref.current;a.style.bottom="0px";const T=d.clientHeight-p.offsetTop-p.offsetHeight,X=Math.max(ce,re+(_?he:0)+T+L),Z=b+X;a.style.height=Z+"px"}else{const _=k.length>0&&h===k[0].ref.current;a.style.top="0px";const X=Math.max(ee,F+p.offsetTop+(_?ge:0)+re)+j;a.style.height=X+"px",p.scrollTop=b-ee+p.offsetTop}a.style.margin=`${A}px 0`,a.style.minHeight=fe+"px",a.style.maxHeight=V+"px",c?.(),requestAnimationFrame(()=>w.current=!0)}},[S,u.trigger,u.valueNode,a,d,p,h,C,u.dir,c]);$(()=>v(),[v]);const[U,M]=r.useState();$(()=>{d&&M(window.getComputedStyle(d).zIndex)},[d]);const ne=r.useCallback(N=>{N&&y.current===!0&&(v(),g?.(),y.current=!1)},[v,g]);return t.jsx(co,{scope:o,contentWrapper:a,shouldExpandOnScrollRef:w,onScrollButtonChange:ne,children:t.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:U},children:t.jsx(R.div,{...i,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});Xe.displayName=ao;var io="SelectPopperPosition",_e=r.forwardRef((e,n)=>{const{__scopeSelect:o,align:c="start",collisionPadding:i=A,...u}=e,s=me(o);return t.jsx(Ft,{...s,...u,ref:n,align:c,collisionPadding:i,style:{boxSizing:"border-box",...u.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});_e.displayName=io;var[co,je]=oe(J,{}),be="SelectViewport",Ze=r.forwardRef((e,n)=>{const{__scopeSelect:o,nonce:c,...i}=e,u=G(be,o),s=je(be,o),a=O(n,u.onViewportChange),l=r.useRef(0);return t.jsxs(t.Fragment,{children:[t.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:c}),t.jsx(ue.Slot,{scope:o,children:t.jsx(R.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:P(i.onScroll,d=>{const x=d.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:S}=s;if(S?.current&&m){const w=Math.abs(l.current-x.scrollTop);if(w>0){const y=window.innerHeight-A*2,p=parseFloat(m.style.minHeight),h=parseFloat(m.style.height),C=Math.max(p,h);if(C<y){const g=C+w,v=Math.min(y,g),U=g-v;m.style.height=v+"px",m.style.bottom==="0px"&&(x.scrollTop=U>0?U:0,m.style.justifyContent="flex-end")}}}l.current=x.scrollTop})})})]})});Ze.displayName=be;var Qe="SelectGroup",[lo,uo]=oe(Qe),po=r.forwardRef((e,n)=>{const{__scopeSelect:o,...c}=e,i=Ee();return t.jsx(lo,{scope:o,id:i,children:t.jsx(R.div,{role:"group","aria-labelledby":i,...c,ref:n})})});po.displayName=Qe;var Je="SelectLabel",mo=r.forwardRef((e,n)=>{const{__scopeSelect:o,...c}=e,i=uo(Je,o);return t.jsx(R.div,{id:i.id,...c,ref:n})});mo.displayName=Je;var de="SelectItem",[fo,et]=oe(de),tt=r.forwardRef((e,n)=>{const{__scopeSelect:o,value:c,disabled:i=!1,textValue:u,...s}=e,a=q(de,o),l=G(de,o),d=a.value===c,[x,m]=r.useState(u??""),[S,w]=r.useState(!1),y=O(n,g=>l.itemRefCallback?.(g,c,i)),p=Ee(),h=r.useRef("touch"),C=()=>{i||(a.onValueChange(c),a.onOpenChange(!1))};if(c==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return t.jsx(fo,{scope:o,value:c,disabled:i,textId:p,isSelected:d,onItemTextChange:r.useCallback(g=>{m(v=>v||(g?.textContent??"").trim())},[]),children:t.jsx(ue.ItemSlot,{scope:o,value:c,disabled:i,textValue:x,children:t.jsx(R.div,{role:"option","aria-labelledby":p,"data-highlighted":S?"":void 0,"aria-selected":d&&S,"data-state":d?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...s,ref:y,onFocus:P(s.onFocus,()=>w(!0)),onBlur:P(s.onBlur,()=>w(!1)),onClick:P(s.onClick,()=>{h.current!=="mouse"&&C()}),onPointerUp:P(s.onPointerUp,()=>{h.current==="mouse"&&C()}),onPointerDown:P(s.onPointerDown,g=>{h.current=g.pointerType}),onPointerMove:P(s.onPointerMove,g=>{h.current=g.pointerType,i?l.onItemLeave?.():h.current==="mouse"&&g.currentTarget.focus({preventScroll:!0})}),onPointerLeave:P(s.onPointerLeave,g=>{g.currentTarget===document.activeElement&&l.onItemLeave?.()}),onKeyDown:P(s.onKeyDown,g=>{l.searchRef?.current!==""&&g.key===" "||(Zt.includes(g.key)&&C(),g.key===" "&&g.preventDefault())})})})})});tt.displayName=de;var ae="SelectItemText",ot=r.forwardRef((e,n)=>{const{__scopeSelect:o,className:c,style:i,...u}=e,s=q(ae,o),a=G(ae,o),l=et(ae,o),d=to(ae,o),[x,m]=r.useState(null),S=O(n,C=>m(C),l.onItemTextChange,C=>a.itemTextRefCallback?.(C,l.value,l.disabled)),w=x?.textContent,y=r.useMemo(()=>t.jsx("option",{value:l.value,disabled:l.disabled,children:w},l.value),[l.disabled,l.value,w]),{onNativeOptionAdd:p,onNativeOptionRemove:h}=d;return $(()=>(p(y),()=>h(y)),[p,h,y]),t.jsxs(t.Fragment,{children:[t.jsx(R.span,{id:l.textId,...u,ref:S}),l.isSelected&&s.valueNode&&!s.valueNodeHasChildren?ke.createPortal(u.children,s.valueNode):null]})});ot.displayName=ae;var nt="SelectItemIndicator",rt=r.forwardRef((e,n)=>{const{__scopeSelect:o,...c}=e;return et(nt,o).isSelected?t.jsx(R.span,{"aria-hidden":!0,...c,ref:n}):null});rt.displayName=nt;var Te="SelectScrollUpButton",st=r.forwardRef((e,n)=>{const o=G(Te,e.__scopeSelect),c=je(Te,e.__scopeSelect),[i,u]=r.useState(!1),s=O(n,c.onScrollButtonChange);return $(()=>{if(o.viewport&&o.isPositioned){let a=function(){const d=l.scrollTop>0;u(d)};const l=o.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[o.viewport,o.isPositioned]),i?t.jsx(it,{...e,ref:s,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=o;a&&l&&(a.scrollTop=a.scrollTop-l.offsetHeight)}}):null});st.displayName=Te;var Pe="SelectScrollDownButton",at=r.forwardRef((e,n)=>{const o=G(Pe,e.__scopeSelect),c=je(Pe,e.__scopeSelect),[i,u]=r.useState(!1),s=O(n,c.onScrollButtonChange);return $(()=>{if(o.viewport&&o.isPositioned){let a=function(){const d=l.scrollHeight-l.clientHeight,x=Math.ceil(l.scrollTop)<d;u(x)};const l=o.viewport;return a(),l.addEventListener("scroll",a),()=>l.removeEventListener("scroll",a)}},[o.viewport,o.isPositioned]),i?t.jsx(it,{...e,ref:s,onAutoScroll:()=>{const{viewport:a,selectedItem:l}=o;a&&l&&(a.scrollTop=a.scrollTop+l.offsetHeight)}}):null});at.displayName=Pe;var it=r.forwardRef((e,n)=>{const{__scopeSelect:o,onAutoScroll:c,...i}=e,u=G("SelectScrollButton",o),s=r.useRef(null),a=pe(o),l=r.useCallback(()=>{s.current!==null&&(window.clearInterval(s.current),s.current=null)},[]);return r.useEffect(()=>()=>l(),[l]),$(()=>{a().find(x=>x.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[a]),t.jsx(R.div,{"aria-hidden":!0,...i,ref:n,style:{flexShrink:0,...i.style},onPointerDown:P(i.onPointerDown,()=>{s.current===null&&(s.current=window.setInterval(c,50))}),onPointerMove:P(i.onPointerMove,()=>{u.onItemLeave?.(),s.current===null&&(s.current=window.setInterval(c,50))}),onPointerLeave:P(i.onPointerLeave,()=>{l()})})}),go="SelectSeparator",ho=r.forwardRef((e,n)=>{const{__scopeSelect:o,...c}=e;return t.jsx(R.div,{"aria-hidden":!0,...c,ref:n})});ho.displayName=go;var Ne="SelectArrow",xo=r.forwardRef((e,n)=>{const{__scopeSelect:o,...c}=e,i=me(o),u=q(Ne,o),s=G(Ne,o);return u.open&&s.position==="popper"?t.jsx(Ht,{...i,...c,ref:n}):null});xo.displayName=Ne;var vo="SelectBubbleInput",ct=r.forwardRef(({__scopeSelect:e,value:n,...o},c)=>{const i=r.useRef(null),u=O(c,i),s=Ut(n);return r.useEffect(()=>{const a=i.current;if(!a)return;const l=window.HTMLSelectElement.prototype,x=Object.getOwnPropertyDescriptor(l,"value").set;if(s!==n&&x){const m=new Event("change",{bubbles:!0});x.call(a,n),a.dispatchEvent(m)}},[s,n]),t.jsx(R.select,{...o,style:{...At,...o.style},ref:u,defaultValue:n})});ct.displayName=vo;function lt(e){return e===""||e===void 0}function dt(e){const n=Dt(e),o=r.useRef(""),c=r.useRef(0),i=r.useCallback(s=>{const a=o.current+s;n(a),(function l(d){o.current=d,window.clearTimeout(c.current),d!==""&&(c.current=window.setTimeout(()=>l(""),1e3))})(a)},[n]),u=r.useCallback(()=>{o.current="",window.clearTimeout(c.current)},[]);return r.useEffect(()=>()=>window.clearTimeout(c.current),[]),[o,i,u]}function ut(e,n,o){const i=n.length>1&&Array.from(n).every(d=>d===n[0])?n[0]:n,u=o?e.indexOf(o):-1;let s=So(e,Math.max(u,0));i.length===1&&(s=s.filter(d=>d!==o));const l=s.find(d=>d.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==o?l:void 0}function So(e,n){return e.map((o,c)=>e[(n+c)%e.length])}var yo=Fe,wo=Ue,Co=ze,Io=Ke,_o=$e,bo=qe,To=Ze,Po=tt,No=ot,Eo=rt,jo=st,Ro=at;function Mo({...e}){return t.jsx(yo,{"data-slot":"select",...e})}function Ao({...e}){return t.jsx(Co,{"data-slot":"select-value",...e})}function Do({className:e,children:n,...o}){return t.jsxs(wo,{"data-slot":"select-trigger",className:te("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-full items-center justify-between rounded-md border bg-transparent px-3 py-2 text-sm shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 [&>span]:line-clamp-1",e),...o,children:[n,t.jsx(Io,{asChild:!0,children:t.jsx(Be,{className:"size-4 opacity-50"})})]})}function Lo({className:e,children:n,position:o="popper",...c}){return t.jsx(_o,{children:t.jsxs(bo,{"data-slot":"select-content",className:te("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md",o==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:o,...c,children:[t.jsx(ko,{}),t.jsx(To,{className:te("p-1",o==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:n}),t.jsx(Vo,{})]})})}function Oo({className:e,children:n,...o}){return t.jsxs(Po,{"data-slot":"select-item",className:te("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...o,children:[t.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:t.jsx(Eo,{children:t.jsx(Pt,{className:"size-4"})})}),t.jsx(No,{children:n})]})}function ko({className:e,...n}){return t.jsx(jo,{"data-slot":"select-scroll-up-button",className:te("flex cursor-default items-center justify-center py-1",e),...n,children:t.jsx(Yt,{className:"size-4"})})}function Vo({className:e,...n}){return t.jsx(Ro,{"data-slot":"select-scroll-down-button",className:te("flex cursor-default items-center justify-center py-1",e),...n,children:t.jsx(Be,{className:"size-4"})})}const Bo="/api/categories",Fo=async(e,n=100)=>{const o=new URLSearchParams;return o.append("per_page",String(n)),(await pt.get(`${Bo}?${o.toString()}`)).data},Ho=e=>Kt({queryKey:["categories",{search:e}],queryFn:async()=>await Fo()}),Uo=St({title:le().min(2,{message:"Le titre doit contenir au moins 2 caractères."}),description:le().optional(),image:Ae().optional(),secondary_images:Me(Ae()).optional(),existing_secondary_images:Me(le()).optional(),category_id:yt([le().min(1,"La catégorie est requise"),wt().min(1,"La catégorie est requise")]).refine(e=>e!==void 0&&e!==""&&e!==null,{message:"La catégorie est requise"})});function on({project:e}){const n=!!e,o=Wt(),c=zt(),i=n?c:o,{data:u,isLoading:s}=Ho(),[a,l]=r.useState(e?.secondary_images||[]),d=mt({resolver:ft(Uo),defaultValues:{title:e?.title??"",description:e?.description??"",image:void 0,secondary_images:[],existing_secondary_images:e?.secondary_images||[],category_id:e?.category_id?String(e.category_id):""}});r.useEffect(()=>{e?.category_id&&u?.data&&d.setValue("category_id",String(e.category_id),{shouldValidate:!0})},[e?.category_id,u?.data,d]),r.useEffect(()=>{console.log("Form values:",d.getValues()),console.log("Project category_id:",e?.category_id),console.log("Categories data:",u?.data)},[d,e?.category_id,u?.data]),r.useEffect(()=>{e&&d.reset({title:e.title,description:e.description||"",image:void 0,secondary_images:[],category_id:e.category_id?String(e.category_id):""})},[e,d]);function x(m){const S=(m.secondary_images||[]).filter(y=>y instanceof File),w={title:m.title,description:m.description||"",image:m.image instanceof File?m.image:void 0,secondary_images:S,existing_secondary_images:a,category_id:typeof m.category_id=="string"&&m.category_id!==""?m.category_id:Number(m.category_id)};n&&e?c.mutate({id:e.id.toString(),data:w},{onSuccess:()=>{Re.visit("/projects/home",{replace:!0})}}):o.mutate(w,{onSuccess:()=>{Re.visit("/projects/home",{replace:!0})}})}return t.jsx(gt,{...d,children:t.jsxs("form",{onSubmit:d.handleSubmit(x),className:"space-y-8 p-4",children:[t.jsxs("div",{className:"flex items-start md:flex-row flex-col space-x-4",children:[t.jsx(se,{control:d.control,name:"image",render:({field:m})=>t.jsx(ht,{label:"Image principale",field:m,defaultImageUrl:e?.image||void 0})}),t.jsxs("div",{className:"w-full md:w-3/4 space-y-4",children:[t.jsx(se,{control:d.control,name:"title",render:({field:m})=>t.jsxs(ye,{children:[t.jsx(we,{children:"Titre du projet"}),t.jsx(Ce,{children:t.jsx(_t,{placeholder:"Titre du projet...",...m})}),t.jsx(xt,{children:"Nom public du projet."}),t.jsx(Ie,{})]})}),t.jsx(se,{control:d.control,name:"category_id",render:({field:m})=>t.jsxs(ye,{children:[t.jsx(we,{children:"Catégorie"}),t.jsx(Ce,{children:t.jsxs(Mo,{onValueChange:m.onChange,value:String(m.value||""),defaultValue:String(m.value||""),children:[t.jsx(Do,{children:t.jsx(Ao,{placeholder:s?"Chargement...":"Sélectionnez une catégorie"})}),t.jsx(Lo,{children:u?.data?.map(S=>t.jsx(Oo,{value:String(S.id),children:S.name},S.id))})]})}),t.jsx(Ie,{})]})}),t.jsx(se,{control:d.control,name:"description",render:({field:m})=>t.jsxs(ye,{children:[t.jsx(we,{children:"Description"}),t.jsx(Ce,{children:t.jsx(vt,{placeholder:"Décrivez le projet en détail...",className:"min-h-[120px]",...m})}),t.jsx(Ie,{})]})}),t.jsx(se,{control:d.control,name:"secondary_images",render:({field:{value:m,onChange:S,...w}})=>t.jsx(bt,{label:"Images secondaires",field:{...w,value:m||[],onChange:y=>{S(y)}},existingImageUrls:a,onExistingImagesChange:l,maxImages:5})})]})]}),t.jsxs(It,{type:"submit",disabled:i.isPending,children:[i.isPending&&t.jsx($t,{className:"mr-2 h-4 w-4 animate-spin"}),n?"Mettre à jour":"Créer le projet"]})]})})}export{on as P};
