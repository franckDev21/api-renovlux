import{j as e,U,a as P,r as l,H as q,L as G}from"./app-m3PxGguJ.js";import{X as V,A as W}from"./app-layout-CjbxCJVU.js";import{d as $}from"./index-4Ns3tNZl.js";import{a as F,c as u,B as c}from"./createLucideIcon-DND3JEdr.js";import{u as X,a as Z,b as J,c as K,F as Q,d as v,e as b,f as y,g as N,i as k,M as Y,h as ee,S as se,T as te,I as ae,o as ie,j as re,k as ne,l as le,s as C,m as ce,n as oe}from"./MultiSelectCreatable-CE147OCx.js";import{I as D}from"./input-CevEqA8s.js";import{L as de}from"./loader-circle-BcJRezGD.js";import{D as L,a as T,b as I,c as M,d as me,e as xe}from"./dialog-2rR1g4Sm.js";import{B as ue}from"./badge-BIb0vVDA.js";/* empty css            */import"./index-D4sN63cl.js";import"./index-Sh5Y-rA4.js";import"./index-DVBMg8L0.js";import"./label-CwMeaytN.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],pe=F("Plus",he);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],fe=F("Search",je);function S({className:s,...t}){return e.jsx("div",{"data-slot":"skeleton",className:u("bg-primary/10 animate-pulse rounded-md",s),...t})}const ve=ie({name:C().min(1,{message:"Le nom du service est requis."}),description:C().min(10,{message:"La description doit contenir au moins 10 caractères."}),is_active:le(),image:ne().optional(),service_items:re(C().min(1,"L'élément ne peut pas être vide")).optional()});function ge({service:s,onSuccess:t,onCancel:a}){const n=!!s,i=X(),d=Z(),m=n?d:i,o=J({resolver:K(ve),defaultValues:{name:s?.name??"",description:s?.description??"",is_active:s?.is_active??!0,service_items:s?.features||[],image:s?.image||void 0}}),j=U.useMemo(()=>s?.features?.map(r=>({value:r,label:r}))||[],[s?.features]),f=r=>{const x=new FormData;x.append("name",r.name),x.append("description",r.description),x.append("is_active",String(r.is_active)),r.image&&r.image instanceof File&&x.append("image",r.image),r.service_items&&r.service_items.length>0&&r.service_items.forEach((g,w)=>{x.append(`service_items[${w}]`,g)}),n&&s?d.mutate({id:s.id.toString(),data:r},{onSuccess:()=>{P.visit("/company-services/home",{replace:!0})}}):i.mutate(r,{onSuccess:()=>{t()}})};return e.jsx(Q,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(f),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 _md:grid-cols-2",children:[e.jsx(v,{control:o.control,name:"name",render:({field:r})=>e.jsxs(b,{children:[e.jsx(y,{children:"Nom du service"}),e.jsx(N,{children:e.jsx(D,{placeholder:"Nom du service",...r})}),e.jsx(k,{})]})}),e.jsx(v,{control:o.control,name:"service_items",render:({field:r})=>e.jsxs(b,{children:[e.jsx(N,{children:e.jsx(Y,{name:"service_items",label:"Fonctionnalités du service",description:"Ajoutez les fonctionnalités de votre service",options:j,value:r.value||[],onChange:r.onChange})}),e.jsx(k,{})]})}),e.jsx(v,{control:o.control,name:"is_active",render:({field:r})=>e.jsxs(b,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(y,{className:"text-base",children:"Statut"}),e.jsx(ee,{children:"Activez ou désactivez la visibilité de ce service"})]}),e.jsx(N,{children:e.jsx(se,{checked:r.value,onCheckedChange:r.onChange})})]})}),e.jsx(v,{control:o.control,name:"description",render:({field:r})=>e.jsxs(b,{children:[e.jsx(y,{children:"Description"}),e.jsx(N,{children:e.jsx(te,{placeholder:"Description détaillée du service",className:"min-h-[100px]",...r})}),e.jsx(k,{})]})}),e.jsx(v,{control:o.control,name:"image",render:({field:r})=>e.jsx(ae,{label:"Image du service",field:r,defaultImageUrl:s?.image})})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(c,{type:"button",variant:"outline",onClick:a,disabled:m.isPending,children:"Annuler"}),e.jsxs(c,{type:"submit",disabled:m.isPending,children:[m.isPending&&e.jsx(de,{className:"mr-2 h-4 w-4 animate-spin"}),n?"Mettre à jour":"Créer le service"]})]})]})})}function be({isOpen:s,service:t,onClose:a,onSuccess:n}){const i=()=>{a(),n?.()};return e.jsx(L,{open:s,onOpenChange:a,children:e.jsxs(T,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsx(I,{children:e.jsx(M,{children:t?"Modifier le service":"Ajouter un nouveau service"})}),e.jsx(ge,{service:t||void 0,onSuccess:i,onCancel:a})]})})}function Ne({isOpen:s,serviceId:t,onClose:a,onSuccess:n}){const i=ce(),d=()=>{t&&i.mutate(t,{onSuccess:()=>{a(),n?.()}})};return e.jsx(L,{open:s,onOpenChange:a,children:e.jsxs(T,{className:"sm:max-w-[425px]",children:[e.jsxs(I,{children:[e.jsx(M,{children:"Supprimer le service"}),e.jsx(me,{children:"Êtes-vous sûr de vouloir supprimer ce service ? Cette action est irréversible."})]}),e.jsxs(xe,{className:"mt-4",children:[e.jsx(c,{variant:"outline",onClick:a,disabled:i.isPending,children:"Annuler"}),e.jsx(c,{variant:"destructive",onClick:d,disabled:i.isPending,className:"ml-2",children:i.isPending?"Suppression...":"Supprimer"})]})]})})}const R=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:u("w-full caption-bottom text-sm",s),...t})}));R.displayName="Table";const E=l.forwardRef(({className:s,...t},a)=>e.jsx("thead",{ref:a,className:u("[&_tr]:border-b",s),...t}));E.displayName="TableHeader";const z=l.forwardRef(({className:s,...t},a)=>e.jsx("tbody",{ref:a,className:u("[&_tr:last-child]:border-0",s),...t}));z.displayName="TableBody";const Se=l.forwardRef(({className:s,...t},a)=>e.jsx("tfoot",{ref:a,className:u("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));Se.displayName="TableFooter";const _=l.forwardRef(({className:s,...t},a)=>e.jsx("tr",{ref:a,className:u("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));_.displayName="TableRow";const h=l.forwardRef(({className:s,...t},a)=>e.jsx("th",{ref:a,className:u("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t}));h.displayName="TableHead";const p=l.forwardRef(({className:s,...t},a)=>e.jsx("td",{ref:a,className:u("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t}));p.displayName="TableCell";const we=l.forwardRef(({className:s,...t},a)=>e.jsx("caption",{ref:a,className:u("mt-4 text-sm text-muted-foreground",s),...t}));we.displayName="TableCaption";function ye({src:s,fallbackSrc:t="/images/placeholder.svg",alt:a,...n}){const[i,d]=l.useState(s),[m,o]=l.useState(!1),j=()=>{m||(d(t),o(!0))};return e.jsx("img",{src:m?t:i,onError:j,alt:a||"",...n})}function ke({services:s,isLoading:t,onEdit:a,onDelete:n}){return console.log("ServicesList - services:",s),console.log("ServicesList - isLoading:",t),console.log("ServicesList - services type:",typeof s),console.log("ServicesList - services length:",s?.length),t?e.jsx("div",{className:"p-4",children:[...Array(5)].map((i,d)=>e.jsxs("div",{className:"mb-4 flex items-center space-x-4 p-4",children:[e.jsx(S,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(S,{className:"h-4 w-3/4"}),e.jsx(S,{className:"h-4 w-1/2"})]}),e.jsx(S,{className:"h-8 w-8 rounded-full"})]},d))}):!s||s.length===0?e.jsx("div",{className:"flex h-48 items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Aucun service trouvé."})})}):e.jsxs(R,{children:[e.jsx(E,{children:e.jsxs(_,{children:[e.jsx(h,{children:"Image"}),e.jsx(h,{children:"Nom"}),e.jsx(h,{children:"Description"}),e.jsx(h,{className:"text-right",children:"Prix"}),e.jsx(h,{children:"Durée"}),e.jsx(h,{children:"Statut"}),e.jsx(h,{className:"text-right",children:"Actions"})]})}),e.jsx(z,{children:s.map(i=>e.jsxs(_,{children:[e.jsx(p,{children:e.jsx("div",{className:"w-12 h-12 rounded-md overflow-hidden",children:e.jsx(ye,{src:i.image,alt:i.name,className:"w-full h-full object-cover"})})}),e.jsx(p,{className:"font-medium",children:i.name}),e.jsx(p,{className:"max-w-xs truncate",children:i.description}),e.jsx(p,{className:"text-right",children:new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(i.price)}),e.jsx(p,{children:i.duration}),e.jsx(p,{children:e.jsx(ue,{variant:i.is_active?"default":"secondary",children:i.is_active?"Actif":"Inactif"})}),e.jsx(p,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>a(i),title:"Modifier",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),e.jsx("path",{d:"m15 5 4 4"})]})}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>n(i.id),className:"text-destructive hover:text-destructive/90",title:"Supprimer",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]})})]})})]},i.id))})]})}function Ce({search:s,isActive:t,onSearchChange:a,onIsActiveChange:n}){const i=s||t!==null,d=()=>{a(""),n(null)};return e.jsxs("div",{className:"flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0",children:[e.jsxs("div",{className:"relative w-full md:max-w-sm",children:[e.jsx(fe,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(D,{type:"search",placeholder:"Rechercher un service...",className:"w-full pl-8",value:s,onChange:m=>a(m.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{variant:t===!0?"default":"outline",onClick:()=>n(t===!0?null:!0),children:"Actifs"}),e.jsx(c,{variant:t===!1?"default":"outline",onClick:()=>n(t===!1?null:!1),children:"Inactifs"}),i&&e.jsxs(c,{variant:"ghost",onClick:d,children:["Réinitialiser",e.jsx(V,{className:"ml-2 h-4 w-4"})]})]})]})}function _e({currentPage:s,totalPages:t,onPageChange:a}){return t<=1?null:e.jsxs("div",{className:"flex items-center justify-end space-x-2 p-4 border-t",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>a(1),disabled:s===1,children:"Première page"}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>a(s-1),disabled:s===1,children:"Précédent"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",s," sur ",t]}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>a(s+1),disabled:s===t,children:"Suivant"}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>a(t),disabled:s===t,children:"Dernière page"})]})}const Fe=[{title:"Tableau de bord",href:$().url},{title:"Services"}];function qe(){const[s,t]=l.useState(""),[a,n]=l.useState(!0),[i,d]=l.useState(1),[m,o]=l.useState(!1),[j,f]=l.useState(null),[r,x]=l.useState(null),{data:g,isLoading:w}=oe({search:s,is_active:a,page:i}),A=O=>{f(O),o(!0)},H=()=>{o(!1),f(null)},B=()=>{x(null)};return e.jsxs(W,{breadcrumbs:Fe,children:[e.jsx(q,{title:"Gestion des services"}),e.jsxs("div",{className:"flex flex-col space-y-6 px-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestion des services"}),e.jsx("p",{className:"text-muted-foreground",children:"Gérez les services proposés par votre entreprise"})]}),e.jsx(c,{asChild:!0,children:e.jsxs(G,{href:"/company-services/create",prefetch:!0,children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Ajouter un service"]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"p-4",children:e.jsx(Ce,{search:s,isActive:a,onSearchChange:t,onIsActiveChange:n})}),e.jsxs("div",{className:"border-t",children:[e.jsx(ke,{services:g?.data||[],isLoading:w,onEdit:A,onDelete:x}),e.jsx(_e,{currentPage:i,totalPages:g?.meta?.last_page||1,onPageChange:d})]})]})]}),e.jsx(be,{isOpen:m,service:j,onClose:()=>{o(!1),f(null)},onSuccess:H}),e.jsx(Ne,{isOpen:!!r,serviceId:r,onClose:()=>x(null),onSuccess:B})]})}export{qe as default};
