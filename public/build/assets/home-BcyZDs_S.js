import{U as A,j as e,a as H,r as u,H as B,L as O}from"./app-D5m8WAa4.js";import{X as R,A as U}from"./app-layout-C8Xx9Ui9.js";import{d as P}from"./index-4Ns3tNZl.js";import{a as q,B as c}from"./createLucideIcon-tfuowmrC.js";import{u as G,a as V,M as W,b as X,c as Z}from"./MultiSelectCreatable--ED5c_sH.js";import{u as $,a as J,o as K,F as Q,b as f,c as g,d as w,e as S,g as y,f as Y,S as ee,T as se,I as ie,h as te,i as re,j as ne,s as C}from"./ImageUploadField-BrBroomz.js";import{I as F}from"./input-Bqu5PeZB.js";import{L as ae}from"./loader-circle-q6HgwlXi.js";import{D as _,a as D,b as L,c as I,d as ce,e as le}from"./dialog-CgNFxbPT.js";import{T as oe,a as de,b as k,c as x,d as me,e as h}from"./table-Bi_08XRJ.js";import{B as ue}from"./badge-B5K8M6aY.js";import{S as N}from"./skeleton-eiiiVRIJ.js";import{P as xe}from"./plus-BZIAxUvx.js";/* empty css            */import"./index-DWQJneQd.js";import"./index-BskZcjYF.js";import"./useMutation-D6vxITMK.js";import"./index-DTw5vJYF.js";import"./label-C2apf17W.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],je=q("Search",he),pe=K({name:C().min(1,{message:"Le nom du service est requis."}),description:C().min(10,{message:"La description doit contenir au moins 10 caractères."}),is_active:ne(),image:re().optional(),service_items:te(C().min(1,"L'élément ne peut pas être vide")).optional()});function fe({service:s,onSuccess:r,onCancel:n}){const a=!!s,i=G(),o=V(),d=a?o:i,l=$({resolver:J(pe),defaultValues:{name:s?.name??"",description:s?.description??"",is_active:s?.is_active??!0,service_items:s?.features||[],image:s?.image||void 0}}),j=A.useMemo(()=>s?.features?.map(t=>({value:t,label:t}))||[],[s?.features]),p=t=>{const m=new FormData;m.append("name",t.name),m.append("description",t.description),m.append("is_active",String(t.is_active)),t.image&&t.image instanceof File&&m.append("image",t.image),t.service_items&&t.service_items.length>0&&t.service_items.forEach((v,b)=>{m.append(`service_items[${b}]`,v)}),a&&s?o.mutate({id:s.id.toString(),data:t},{onSuccess:()=>{H.visit("/company-services/home",{replace:!0})}}):i.mutate(t,{onSuccess:()=>{r()}})};return e.jsx(Q,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(p),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 _md:grid-cols-2",children:[e.jsx(f,{control:l.control,name:"name",render:({field:t})=>e.jsxs(g,{children:[e.jsx(w,{children:"Nom du service"}),e.jsx(S,{children:e.jsx(F,{placeholder:"Nom du service",...t})}),e.jsx(y,{})]})}),e.jsx(f,{control:l.control,name:"service_items",render:({field:t})=>e.jsxs(g,{children:[e.jsx(S,{children:e.jsx(W,{name:"service_items",label:"Fonctionnalités du service",description:"Ajoutez les fonctionnalités de votre service",options:j,value:t.value||[],onChange:t.onChange})}),e.jsx(y,{})]})}),e.jsx(f,{control:l.control,name:"is_active",render:({field:t})=>e.jsxs(g,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(w,{className:"text-base",children:"Statut"}),e.jsx(Y,{children:"Activez ou désactivez la visibilité de ce service"})]}),e.jsx(S,{children:e.jsx(ee,{checked:t.value,onCheckedChange:t.onChange})})]})}),e.jsx(f,{control:l.control,name:"description",render:({field:t})=>e.jsxs(g,{children:[e.jsx(w,{children:"Description"}),e.jsx(S,{children:e.jsx(se,{placeholder:"Description détaillée du service",className:"min-h-[100px]",...t})}),e.jsx(y,{})]})}),e.jsx(f,{control:l.control,name:"image",render:({field:t})=>e.jsx(ie,{label:"Image du service",field:t,defaultImageUrl:s?.image})})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(c,{type:"button",variant:"outline",onClick:n,disabled:d.isPending,children:"Annuler"}),e.jsxs(c,{type:"submit",disabled:d.isPending,children:[d.isPending&&e.jsx(ae,{className:"mr-2 h-4 w-4 animate-spin"}),a?"Mettre à jour":"Créer le service"]})]})]})})}function ve({isOpen:s,service:r,onClose:n,onSuccess:a}){const i=()=>{n(),a?.()};return e.jsx(_,{open:s,onOpenChange:n,children:e.jsxs(D,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsx(L,{children:e.jsx(I,{children:r?"Modifier le service":"Ajouter un nouveau service"})}),e.jsx(fe,{service:r||void 0,onSuccess:i,onCancel:n})]})})}function ge({isOpen:s,serviceId:r,onClose:n,onSuccess:a}){const i=X(),o=()=>{r&&i.mutate(r,{onSuccess:()=>{n(),a?.()}})};return e.jsx(_,{open:s,onOpenChange:n,children:e.jsxs(D,{className:"sm:max-w-[425px]",children:[e.jsxs(L,{children:[e.jsx(I,{children:"Supprimer le service"}),e.jsx(ce,{children:"Êtes-vous sûr de vouloir supprimer ce service ? Cette action est irréversible."})]}),e.jsxs(le,{className:"mt-4",children:[e.jsx(c,{variant:"outline",onClick:n,disabled:i.isPending,children:"Annuler"}),e.jsx(c,{variant:"destructive",onClick:o,disabled:i.isPending,className:"ml-2",children:i.isPending?"Suppression...":"Supprimer"})]})]})})}function Se({src:s,fallbackSrc:r="/images/placeholder.svg",alt:n,...a}){const[i,o]=u.useState(s),[d,l]=u.useState(!1),j=()=>{d||(o(r),l(!0))};return e.jsx("img",{src:d?r:i,onError:j,alt:n||"",...a})}function Ne({services:s,isLoading:r,onEdit:n,onDelete:a}){return console.log("ServicesList - services:",s),console.log("ServicesList - isLoading:",r),console.log("ServicesList - services type:",typeof s),console.log("ServicesList - services length:",s?.length),r?e.jsx("div",{className:"p-4",children:[...Array(5)].map((i,o)=>e.jsxs("div",{className:"mb-4 flex items-center space-x-4 p-4",children:[e.jsx(N,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(N,{className:"h-4 w-3/4"}),e.jsx(N,{className:"h-4 w-1/2"})]}),e.jsx(N,{className:"h-8 w-8 rounded-full"})]},o))}):!s||s.length===0?e.jsx("div",{className:"flex h-48 items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Aucun service trouvé."})})}):e.jsxs(oe,{children:[e.jsx(de,{children:e.jsxs(k,{children:[e.jsx(x,{children:"Image"}),e.jsx(x,{children:"Nom"}),e.jsx(x,{children:"Description"}),e.jsx(x,{className:"text-right",children:"Prix"}),e.jsx(x,{children:"Durée"}),e.jsx(x,{children:"Statut"}),e.jsx(x,{className:"text-right",children:"Actions"})]})}),e.jsx(me,{children:s.map(i=>e.jsxs(k,{children:[e.jsx(h,{children:e.jsx("div",{className:"w-12 h-12 rounded-md overflow-hidden",children:e.jsx(Se,{src:i.image,alt:i.name,className:"w-full h-full object-cover"})})}),e.jsx(h,{className:"font-medium",children:i.name}),e.jsx(h,{className:"max-w-xs truncate",children:i.description}),e.jsx(h,{className:"text-right",children:new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(i.price)}),e.jsx(h,{children:i.duration}),e.jsx(h,{children:e.jsx(ue,{variant:i.is_active?"default":"secondary",children:i.is_active?"Actif":"Inactif"})}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>n(i),title:"Modifier",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),e.jsx("path",{d:"m15 5 4 4"})]})}),e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>a(i.id),className:"text-destructive hover:text-destructive/90",title:"Supprimer",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]})})]})})]},i.id))})]})}function be({search:s,isActive:r,onSearchChange:n,onIsActiveChange:a}){const i=s||r!==null,o=()=>{n(""),a(null)};return e.jsxs("div",{className:"flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0",children:[e.jsxs("div",{className:"relative w-full md:max-w-sm",children:[e.jsx(je,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(F,{type:"search",placeholder:"Rechercher un service...",className:"w-full pl-8",value:s,onChange:d=>n(d.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{variant:r===!0?"default":"outline",onClick:()=>a(r===!0?null:!0),children:"Actifs"}),e.jsx(c,{variant:r===!1?"default":"outline",onClick:()=>a(r===!1?null:!1),children:"Inactifs"}),i&&e.jsxs(c,{variant:"ghost",onClick:o,children:["Réinitialiser",e.jsx(R,{className:"ml-2 h-4 w-4"})]})]})]})}function we({currentPage:s,totalPages:r,onPageChange:n}){return r<=1?null:e.jsxs("div",{className:"flex items-center justify-end space-x-2 p-4 border-t",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>n(1),disabled:s===1,children:"Première page"}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>n(s-1),disabled:s===1,children:"Précédent"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",s," sur ",r]}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>n(s+1),disabled:s===r,children:"Suivant"}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>n(r),disabled:s===r,children:"Dernière page"})]})}const ye=[{title:"Tableau de bord",href:P().url},{title:"Services"}];function Ge(){const[s,r]=u.useState(""),[n,a]=u.useState(!0),[i,o]=u.useState(1),[d,l]=u.useState(!1),[j,p]=u.useState(null),[t,m]=u.useState(null),{data:v,isLoading:b}=Z({search:s,is_active:n,page:i}),M=z=>{p(z),l(!0)},E=()=>{l(!1),p(null)},T=()=>{m(null)};return e.jsxs(U,{breadcrumbs:ye,children:[e.jsx(B,{title:"Gestion des services"}),e.jsxs("div",{className:"flex flex-col space-y-6 px-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestion des services"}),e.jsx("p",{className:"text-muted-foreground",children:"Gérez les services proposés par votre entreprise"})]}),e.jsx(c,{asChild:!0,children:e.jsxs(O,{href:"/company-services/create",prefetch:!0,children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Ajouter un service"]})})]}),e.jsxs("div",{className:"rounded-lg border bg-card",children:[e.jsx("div",{className:"p-4",children:e.jsx(be,{search:s,isActive:n,onSearchChange:r,onIsActiveChange:a})}),e.jsxs("div",{className:"border-t",children:[e.jsx(Ne,{services:v?.data||[],isLoading:b,onEdit:M,onDelete:m}),e.jsx(we,{currentPage:i,totalPages:v?.meta?.last_page||1,onPageChange:o})]})]})]}),e.jsx(ve,{isOpen:d,service:j,onClose:()=>{l(!1),p(null)},onSuccess:E}),e.jsx(ge,{isOpen:!!t,serviceId:t,onClose:()=>m(null),onSuccess:T})]})}export{Ge as default};
