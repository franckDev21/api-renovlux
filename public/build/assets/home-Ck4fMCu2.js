import{r as n,j as e,a as g,H as R,L as M}from"./app-CXlkSNpp.js";import{D as C,b as w,c as b,d as k,e as D,f as c,g as I,A}from"./app-layout-BAa8lCS0.js";import{d as T}from"./index-4Ns3tNZl.js";import{B as o}from"./createLucideIcon-TuM7M0fl.js";import{u as V,f as h,g as F,a as H,b as L,c as E,A as x,E as z}from"./index-BG6_3_t0.js";import{T as _,a as B,b as u,c as G,d as K,e as j}from"./table-DDpxDCWc.js";import{I as $}from"./input-DNPMUi4O.js";import{C as p}from"./checkbox-CI_UBlM-.js";import{c as O,d as U}from"./useProjects-BPdE8pow.js";import{I as q}from"./image-DALyzu55.js";import{S as f}from"./skeleton-DkmOLbKu.js";import{P as J}from"./plus-Ct8jtTmn.js";/* empty css            */import"./index-Dt3f-TAq.js";import"./index-Dd6kHcB0.js";import"./index-BGOW-8nH.js";import"./useMutation-Snm-uatt.js";function Q({columns:l,data:s}){const[t,d]=n.useState([]),[m,v]=n.useState([]),[S,N]=n.useState({}),[y,P]=n.useState({}),a=V({data:s,columns:l,getCoreRowModel:E(),getPaginationRowModel:L(),onSortingChange:d,getSortedRowModel:H(),onColumnFiltersChange:v,getFilteredRowModel:F(),onColumnVisibilityChange:N,onRowSelectionChange:P,state:{sorting:t,columnFilters:m,columnVisibility:S,rowSelection:y}});return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center py-4",children:[e.jsx($,{placeholder:"Rechercher par titre...",value:a.getColumn("title")?.getFilterValue()??"",onChange:r=>a.getColumn("title")?.setFilterValue(r.target.value),className:"max-w-sm"}),e.jsxs(C,{children:[e.jsx(w,{asChild:!0,children:e.jsx(o,{variant:"outline",className:"ml-auto",children:"Colonnes"})}),e.jsx(b,{align:"end",children:a.getAllColumns().filter(r=>r.getCanHide()).map(r=>e.jsx(k,{className:"capitalize",checked:r.getIsVisible(),onCheckedChange:i=>r.toggleVisibility(!!i),children:r.id},r.id))})]})]}),e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs(_,{children:[e.jsx(B,{children:a.getHeaderGroups().map(r=>e.jsx(u,{children:r.headers.map(i=>e.jsx(G,{children:i.isPlaceholder?null:h(i.column.columnDef.header,i.getContext())},i.id))},r.id))}),e.jsx(K,{children:a.getRowModel().rows?.length?a.getRowModel().rows.map(r=>e.jsx(u,{"data-state":r.getIsSelected()&&"selected",children:r.getVisibleCells().map(i=>e.jsx(j,{children:h(i.column.columnDef.cell,i.getContext())},i.id))},r.id)):e.jsx(u,{children:e.jsx(j,{colSpan:l.length,className:"h-24 text-center",children:"Aucun résultat."})})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 py-4",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>a.previousPage(),disabled:!a.getCanPreviousPage(),children:"Précédent"}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>a.nextPage(),disabled:!a.getCanNextPage(),children:"Suivant"})]})]})}const W=()=>{const l=O();return n.useMemo(()=>[{id:"select",header:({table:s})=>e.jsx(p,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t),"aria-label":"Sélectionner tout"}),cell:({row:s})=>e.jsx(p,{checked:s.getIsSelected(),onCheckedChange:t=>s.toggleSelected(!!t),"aria-label":"Sélectionner la ligne"}),enableSorting:!1,enableHiding:!1},{accessorKey:"image",header:"Image",cell:({row:s})=>{const t=s.getValue("image");return e.jsx("div",{className:"w-16 h-16 rounded-md overflow-hidden border flex items-center justify-center bg-muted",children:t?e.jsx("img",{src:t,alt:s.original.title,className:"w-full h-full object-cover"}):e.jsx(q,{className:"h-5 w-5 text-muted-foreground"})})},enableSorting:!1},{accessorKey:"title",header:({column:s})=>e.jsxs(o,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Titre",e.jsx(x,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>e.jsx("div",{className:"font-medium",children:s.getValue("title")})},{accessorKey:"created_at",header:({column:s})=>e.jsxs(o,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Date de création",e.jsx(x,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>{const t=new Date(s.getValue("created_at"));return e.jsx("div",{children:t.toLocaleDateString("fr-FR")})}},{id:"actions",cell:({row:s})=>{const t=s.original;return e.jsxs(C,{children:[e.jsx(w,{asChild:!0,children:e.jsxs(o,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Ouvrir le menu"}),e.jsx(z,{className:"h-4 w-4"})]})}),e.jsxs(b,{align:"end",children:[e.jsx(D,{children:"Actions"}),e.jsx(c,{onClick:()=>navigator.clipboard.writeText(t.id),children:"Copier l'ID du projet"}),e.jsx(I,{}),e.jsx(c,{onClick:()=>g.visit(`/projects/${t.id}`),children:"Voir les détails"}),e.jsx(c,{onClick:()=>g.visit(`/projects/${t.id}/edit`),children:"Modifier"}),e.jsx(c,{className:"text-destructive",onClick:()=>{confirm("Confirmer la suppression de ce projet ?")&&l.mutate(t.id.toString())},children:"Supprimer"})]})]})}}],[l])};function X(){const{data:l,isLoading:s,error:t}=U(),d=W();if(s)return e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(f,{className:"h-10 w-full"}),e.jsx(f,{className:"h-64 w-full"})]});if(t)return console.error("Erreur chargement projets:",t),e.jsx("div",{className:"p-4 text-center text-destructive",children:"Erreur lors du chargement des projets. Veuillez réessayer."});console.log("Données reçues de l'API:",l);const m=Array.isArray(l)?l:l?.data||[];return e.jsx("div",{children:e.jsx(Q,{columns:d,data:m})})}const Y=[{title:"Tableau de bord",href:T().url},{title:"Projets"}];function je(){return e.jsxs(A,{breadcrumbs:Y,children:[e.jsx(R,{title:"Gestion des projets"}),e.jsxs("div",{className:"flex flex-col space-y-6 px-6",children:[e.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestion des projets"}),e.jsx("p",{className:"text-muted-foreground",children:"Gérez les projets de votre catalogue"})]}),e.jsx(o,{asChild:!0,children:e.jsxs(M,{href:"/projects/create",prefetch:!0,children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Ajouter un projet"]})})]}),e.jsx("div",{className:"rounded-lg border bg-card",children:e.jsx(X,{})})]})]})}export{je as default};
